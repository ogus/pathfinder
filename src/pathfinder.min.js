!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof module&&module.exports?module.exports=e():t.Pathfinder=e()}(this,function(){"use strict";function t(t){this.data=[],this.score=t}t.prototype={push:function(t){this.data.push(t),this.sinkDown(this.data.length-1)},pop:function(){let t=this.data[0],e=this.data.pop();return this.data.length>0&&(this.data[0]=e,this.bubbleUp(0)),t},remove:function(t){let e=this.data.indexOf(t),n=this.data.pop();e!==this.data.length-1&&(this.data[i]=n,this.score(n)<this.score(t)?this.sinkDown(e):this.bubbleUp(e))},size:function(){return this.data.length},rescoreElement:function(t){this.sinkDown(this.data.indexOf(t))},sinkDown:function(t){let e=this.data[t],n=this.score(e),s=0,i=null;for(;t>0&&(s=(t+1>>1)-1,i=this.data[s],n<this.score(i));)this.data[s]=e,this.data[t]=i,t=s},bubbleUp:function(t){let e,n,s=this.data[t],i=this.score(s),r=0,o=null;for(;o=null,(e=(n=t+1<<1)-1)<this.data.length&&(r=this.score(this.data[e]))<i&&(o=e),n<this.data.length&&this.score(this.data[n])<(null===o?i:r)&&(o=n),null!==o;)this.data[t]=this.data[o],this.data[o]=s,t=o}};var e=function(){this.nodes={}};function n(t,e){return Math.abs(t.column-e.column)+Math.abs(t.row-e.row)}function s(t,e,n){if(!e||!n)return u(null,null);let s=[];s.push(e);let i=null,r=null,o=[];for(;s.length>0;){if((i=s.shift()).id==n.id)return u(e,n);o=t.getNeighbors(i);for(let t=0;t<o.length;t++)(r=o[t]).parent_node||(r.parent_node=i,s.push(r))}return u(e,null)}function r(e,s,i){if(!s||!i)return u(null,null);let r=new t(function(t){return t.f});r.push(s);let o=null,l=null,h=[];for(;r.size()>0;){if((o=r.pop()).id==i.id)return u(s,i);h=e.getNeighbors(o);for(let t=0;t<h.length;t++)(l=h[t]).parent_node||(l.f=l.f||n(l,i),l.parent_node=o,r.push(l))}return u(s,null)}function o(e,n,s){if(!n||!s)return u(null,null);let i=new t(function(t){return t.f});i.push(n);let r=null,o=null,l=[],h=0;for(;i.size()>0;){if((r=i.pop()).id==s.id)return u(n,s);l=e.getNeighbors(r);for(let t=0;t<l.length;t++)o=l[t],h=(r.f||0)+(o.cost||0),(!o.visited||h<o.f)&&(o.f=h,o.parent_node=r,o.visited?i.rescoreElement(o):(o.visited=!0,i.push(o)))}return u(n,null)}function l(e,s,i){if(!s||!i)return u(null,null);let r=new t(function(t){return t.f});r.push(s);let o=null,l=null,h=[],a=0;for(;r.size()>0;){if((o=r.pop()).id==i.id)return u(s,i);h=e.getNeighbors(o);for(let t=0;t<h.length;t++)l=h[t],a=(o.g||0)+(l.cost||0),(!l.visited||a<l.g)&&(l.g=a,l.f=l.g+n(l,i),l.parent_node=o,l.visited?r.rescoreElement(l):(l.visited=!0,r.push(l)))}return u(s,null)}function u(t,e){let n={path:[],cost:0};if(null!=t&&null!=e){let s=e;for(;s.id!==t.id;)n.cost+=s.f?s.cost:1,n.path.push(s),s=s.parent_node;n.path.push(t)}return n}e.prototype={createId:function(t,e){return t+","+e},getNodeById:function(t){return this.nodes.hasOwnProperty(t)?this.nodes[t]:null},getNeighbors:function(t){let e=[],n=null;for(let s=0;s<t.neighbors.length;s++)null!=(n=this.getNodeById(t.neighbors[s]))&&e.push(n);return e},createFrom2DArray:function(t,e){"function"!=typeof e&&(e=function(t,e,n){return{row:e,column:n,value:t[e][n],cost:0}}),this.nodes={};let n=t.length,s=t[0].length,i=null;for(let r=0;r<n;r++)for(let n=0;n<s;n++)null!=(i=e(t,r,n))&&(i.id=this.createId(r,n),i.neighbors=[],i.neighbors.push(this.createId(r-1,n)),i.neighbors.push(this.createId(r+1,n)),i.neighbors.push(this.createId(r,n-1)),i.neighbors.push(this.createId(r,n+1)),this.nodes[i.id]=i)}};var Pathfinder={};return Pathfinder.Graph=e,Pathfinder.bfs=s,Pathfinder.greedy=r,Pathfinder.dijkstra=o,Pathfinder.astar=l,Pathfinder.async=function(t,e,n,i){return new Promise(function(u,h){"bfs"===t?resove(s(e,n,i)):"greedy"===t?resove(r(e,n,i)):"dijkstra"===t?resove(o(e,n,i)):"astar"===t&&resove(l(e,n,i))})},"undefined"!=typeof self&&(self.onmessage=function(t){let e=t.data.type,n=null;"bfs"===e?n=s(graph,start_node,end_node):"greedy"===e?n=r(graph,start_node,end_node):"dijkstra"===e?n=o(graph,start_node,end_node):"astar"===e&&(n=l(graph,start_node,end_node)),postMessage(n)}),Pathfinder});
